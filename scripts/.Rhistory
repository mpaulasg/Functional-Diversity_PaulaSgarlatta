kelp_summary <- mFD::asb.sp.summary(asb_sp_w = kelp_sp_maxN)
# retrieve occurrence matrix:
kelp_sp_occ_transect <- kelp_summary$asb_sp_occ
# dimensions
dim(kelp_sp_occ_transect) # 69 assemblages * 101 species
# names of species
kelp_sp <- colnames(kelp_sp_occ_transect)
length(kelp_sp) # 101 sp
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("from_paula",  "SpatialUVC_metadata_transect.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("from_paula", "SpatialUVC_species_biomass_transect.csv")) %>%
column_to_rownames("Code") %>%
as.matrix()
spatial_sp_biom <- read.csv(here::here("from_paula", "SpatialUVC_species_biomass_transect.csv")) %>%
column_to_rownames("Code") %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 53 species
# summary of surveys and occurrences data ----
spatial_summary_tranect <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ_transect <- spatial_summary_tranect$asb_sp_occ
# species names
spatial_sp_transect <- colnames(spatial_sp_occ_transect)
length(spatial_sp_transect) # 53
## names of species present in at least one dataset ####
sum(spatial_sp_transect %in% kelp_sp)# 35 species shared
species_allsurveys <- unique( c(kelp_sp ,  spatial_sp_transect) )
length(species_allsurveys) # 119 species
save(kelp_sp_occ, file=here::here("data", "kelp_sp_occ_transect.RData") )
save(kelp_sp_occ_transect, file=here::here("data", "kelp_sp_occ_transect.RData") )
save(spatial_sp_occ, file=here::here("data", "spatial_sp_occ_transect.RData") )
save(spatial_sp_occ_transect, file=here::here("data", "spatial_sp_occ_transect.RData") )
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
# loading data
load(here::here("data", "kelp_sp_occ_transect.RData") )
load(here::here("outputs", "sp_3D_coord.RData") )
load(here::here("data", "spatial_sp_occ_transect.RData") )
temporal_fd_kelp_transect <- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_3D_coord,
asb_sp_w         = kelp_sp_occ_transect,
ind_vect         = c("fide", "fric", "fdis"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)
temporal_alpha_kelp_transect <- temporal_fd_kelp_transect$functional_diversity_indices
spatial_fd_transect <- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_3D_coord,
asb_sp_w         = spatial_sp_occ_transect,
ind_vect         = c("fide", "fric", "fdis"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)
spatial_alpha_transect <- spatial_fd_transect$functional_diversity_indices
save(temporal_fd_kelp_transect, file=here::here("outputs/", "temporal_fd_kelp_transect.RData") )
save(temporal_alpha_kelp_transect, file=here::here("outputs/", "temporal_alpha_kelp_transect.RData") )
save(spatial_fd_transect, file=here::here("outputs/", "spatial_fd_transect.RData") )
save(spatial_alpha_transect, file=here::here("outputs/", "spatial_alpha_transect.RData") )
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp_transect.RData") )
load(here::here("outputs", "spatial_alpha_transect.RData") )
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
View(kelp_stats)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
mutate(replicate=substr(Site,1,1)) %>%
select(-Site1)
read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
kelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
View(kelp_stats)
kelp_stats <- temporal_alpha_kelp_transect
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Species", "Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_shape <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code")
kelp_stats <- inner_join(kelp_shape, kelp_metadata[ , c("Species", "Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_shape, kelp_metadata[ , c("Site", "Year")], by = c("Code"), all.x=TRUE)
View(kelp_stats)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code")
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_shape <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code")
kelp_stats <- inner_join(kelp_shape, kelp_metadata[ , c("Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- inner_join(kelp_shape, kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE)
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
spatial_metadata <- read.csv(here::here("from_paula", "SpatialUVC_metadata_transect.csv"))
spatial_stats <- spatial_alpha_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(spatial_metadata[ , c("Code", "Site", "Habitat")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
View(spatial_stats)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp_transect.RData") )
load(here::here("outputs", "spatial_alpha_transect.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
kelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
spatial_metadata <- read.csv(here::here("from_paula", "SpatialUVC_metadata_transect.csv"))
## Preparing data for stats
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
spatial_stats <- spatial_alpha_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(spatial_metadata[ , c("Code", "Site", "Habitat")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
kelp_s <- glmmTMB(sp_richn ~ Year_cont + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
kelp_res_s <- simulateResiduals(kelp_s)
plot(kelp_res_s) #Good
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = poisson())
summary(space_s)
Anova(space_s)#Significant
space_res_s <- simulateResiduals(space_s)
plot(space_res_s) #Good
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = nbinom1())
summary(space_s)
Anova(space_s)#Not significant
space_res_s <- simulateResiduals(space_s)
plot(space_res_s) #Good
space_s <- glmmTMB (log(sp_richn) ~ Habitat + (1|Site), data=spatial_stats, family = nbinom1())
summary(space_s)
Anova(space_s)#Not significant
space_res_s <- simulateResiduals(space_s)
plot(space_res_s) #Good
space_lm_s <- lmer(sp_richn ~ Habitat + (1|Site), data = spatial_stats)
Anova(space_lm_s)
space_res_s <- simulateResiduals(space_lm_s)
plot(space_res_s) #Good
kelp_fric <- glmmTMB(fric ~ Year + (1|Site), data=kelp_stats, family=beta_family())
summary(kelp_fric)
Anova(kelp_fric)#Significant
kelp_res_fric <- simulateResiduals(kelp_fric)
plot(kelp_res_fric) # Good
kelp_fric <- glmmTMB(fric ~ Year_cont + (1|Site), data=kelp_stats, family=beta_family())
summary(kelp_fric)
Anova(kelp_fric)#Significant
spatial_fric <- glmmTMB (fric ~ Habitat + (1|Site) , data=spatial_stats, family = beta_family())
summary(spatial_fric)
Anova(spatial_fric)#Significant
spatial_res_fric <- simulateResiduals(spatial_fric)
plot(spatial_res_fric) # Good
kelp_fdis <- glmmTMB(fdis ~ Year + (1|Site), data=kelp_stats, family = beta_family())
summary(kelp_fdis)
Anova(kelp_fdis)#Significative
kelp_res_fdis <- simulateResiduals(kelp_fdis)
plot(kelp_res_fdis) # Good
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
View(kelp_stats)
summary(kelp_s)
Anova(kelp_s)#Significant
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
kelp_s <- glmmTMB(sp_richn ~ Year_cont + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
## Preparing data for stats
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_s <- glmmTMB(sp_richn ~ Year_cont + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp_transect.RData") )
load(here::here("outputs", "spatial_alpha_transect.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
kelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
spatial_metadata <- read.csv(here::here("from_paula", "SpatialUVC_metadata_transect.csv"))
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(spatial_metadata[ , c("Code", "Site", "Habitat")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
kelp_s <- glmmTMB(sp_richn ~ Year_cont + (1|Site), data=kelp_stats, family = poisson())
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
kelp_res_s <- simulateResiduals(kelp_s)
plot(kelp_res_s) #Good
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = nbinom1())
space_lm_s <- lmer(sp_richn ~ Habitat + (1|Site), data = spatial_stats)
Anova(space_lm_s)
summary(space_s)
Anova(space_s)#Not significant
space_res_s <- simulateResiduals(space_lm_s)
plot(space_res_s) #Good
pairs(emmeans(space_s, spec=~Habitat, type="response"))
kelp_fric <- glmmTMB(fric ~ Year_cont + (1|Site), data=kelp_stats, family=beta_family())
summary(kelp_fric)
Anova(kelp_fric)#Significant
kelp_res_fric <- simulateResiduals(kelp_fric)
plot(kelp_res_fric) # Good
spatial_fric <- glmmTMB (fric ~ Habitat + (1|Site) , data=spatial_stats, family = beta_family())
summary(spatial_fric)
Anova(spatial_fric)#Significant
View(spatial_fric)
View(spatial_stats)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
system.time(mod_1 <- drop1(kelp_s, test = "Chisq", all.cols=TRUE))
print(mod_1)
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = poisson())
summary(space_s)
Anova(space_s)#Significant
space_res_s <- simulateResiduals(space_s)
plot(space_res_s) #Good
system.time(space_mod_s <- drop1(space_s test = "Chisq", all.cols=TRUE))
system.time(space_mod_s <- drop1(space_s, test = "Chisq", all.cols=TRUE))
print(space_mod_s)
kelp_fric <- glmmTMB(fric ~ Year + (1|Site), data=kelp_stats, family=beta_family())
summary(kelp_fric)
Anova(kelp_fric)#Significant
system.time(kelp_mod_fric <- drop1(kelp_fric, test = "Chisq", all.cols=TRUE))
print(kelp_mod_fric)
spatial_fric <- glmmTMB (fric ~ Habitat + (1|Site) , data=spatial_stats, family = beta_family())
summary(spatial_fric)
Anova(spatial_fric)#Significant
system.time(spatial_mod_fric <- drop1(spatial_fric, test = "Chisq", all.cols=TRUE))
print(spatial_mod_fric)
kelp_fdis <- glmmTMB(fdis ~ Year + (1|Site), data=kelp_stats, family = beta_family())
summary(kelp_fdis)
Anova(kelp_fdis)#Significative
kelp_res_fdis <- simulateResiduals(kelp_fdis)
plot(kelp_res_fdis) # Good
system.time(kelp_mod_fdis <- drop1(kelp_fdis, test = "Chisq", all.cols=TRUE))
print(kelp_mod_fdis)
spatial_fdis <- glmmTMB (fdis ~ Habitat, data=spatial_stats, family = beta_family())
summary(spatial_fdis)
Anova(spatial_fdis)# No diferences - p=0.1097
system.time(spatial_mod_fdis <- drop1(spatial_fdis, test = "Chisq", all.cols=TRUE))
print(spatial_mod_fdis)
kelp_fide1 <- glmmTMB(fide_PC1 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
summary(kelp_fide1)
Anova(kelp_fide1) #No significant - p=0.2234
system.time(kelp_mod_fide1 <- drop1(kelp_fide1, test = "Chisq", all.cols=TRUE))
print(kelp_mod_fide1)
spatial_fide1 <- glmmTMB (fide_PC1 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide1)
Anova(spatial_fide1)# Not significant - p=0.25
spatial_res_fide1 <- simulateResiduals(spatial_fide1)
plot(spatial_res_fide1) # Good
system.time(spatial_mod_fide1 <- drop1(spatial_fide1, test = "Chisq", all.cols=TRUE))
print(spatial_mod_fide1)
spatial_fide1 <- glmmTMB (fide_PC1 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide1)
spatial_fide1 <- lm(fide_PC1 ~ Habitat, data=spatial_stats)
summary(spatial_fide1)
Anova(spatial_fide1)# Not significant - p=0.25
kelp_fide2 <- glmmTMB(fide_PC2 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
kelp_fide2 <- lmer (fide_PC2 ~ Year + (1|Site), data=kelp_stats)
summary(kelp_fide2)
Anova(kelp_fide2) #Significant
system.time(kelp_mod_fide2 <- drop1(kelp_fide2, test = "Chisq", all.cols=TRUE))
print(kelp_mod_fide2)
spatial_fide2 <- glmmTMB (fide_PC2 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide2)
Anova(spatial_fide2) #Not significant - p=0.831
system.time(spatial_mod_fide2 <- drop1(spatial_fide2, test = "Chisq", all.cols=TRUE))
print(spatial_mod_fide2)
kelp_fide3 <- glmmTMB(fide_PC3 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
summary(kelp_fide3)
Anova(kelp_fide3) #Not significant - p=0.1684
kelp_res_fide3 <- simulateResiduals(kelp_fide3)
plot(kelp_res_fide3) # Good
system.time(kelp_mod_fide3 <- drop1(kelp_fide3, test = "Chisq", all.cols=TRUE))
print(kelp_mod_fide3)
spatial_fide3 <- glmmTMB (fide_PC3 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide3)
Anova(spatial_fide3) #Not significant - p=0.25
spatial_res_fide3 <- simulateResiduals(spatial_fide3)
plot(spatial_res_fide3) # Good
system.time(spatial_mod_fide3 <- drop1(spatial_fide3, test = "Chisq", all.cols=TRUE))
print(spatial_mod_fide3)
shift3D_kelp_stats$Year_cont <- as.numeric(shift3D_kelp_stats$Year)
kelp_shift <- lmer (shift3D ~ Year_cont + (1|Site1), data=shift3D_kelp_stats)
summary(kelp_shift)
Anova(kelp_shift)
system.time(shift_mod <- drop1(kelp_shift, test = "Chisq", all.cols=TRUE))
print(shift_mod)
kelp_shift <- lmer (shift3D ~ Year + (1|Site1), data=shift3D_kelp_stats)
summary(kelp_shift)
Anova(kelp_shift)
system.time(shift_mod <- drop1(kelp_shift, test = "Chisq", all.cols=TRUE))
print(shift_mod)
space_shift <- glmmTMB (shift3D ~ Habitat , data=shift3D_space_stats)
summary(space_shift)
Anova(space_shift)
system.time(shift_mod_space <- drop1(space_shift, test = "Chisq", all.cols=TRUE))
print(shift_mod_space)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(here)
load(here::here("outputs", "temporal_alpha_kelp_transect.RData") )
load(here::here("outputs", "spatial_alpha_transect.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_stats.RData") )
kelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
spatial_metadata <- read.csv(here::here("from_paula", "SpatialUVC_metadata_transect.csv"))
kelp_stats <- temporal_alpha_kelp_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(kelp_metadata[ , c("Code", "Site", "Year")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
kelp_stats$Year_cont <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha_transect %>%
rownames_to_column(var = "Code") %>%
inner_join(spatial_metadata[ , c("Code", "Site", "Habitat")], by = c("Code"), all.x=TRUE) %>%
select(-Code)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = nbinom1())
Anova(space_lm_s)
summary(space_s)
Anova(space_s)#Not significant
kelp_fric <- glmmTMB(fric ~ Year_cont + (1|Site), data=kelp_stats, family=beta_family())
summary(kelp_fric)
Anova(kelp_fric)#Significant
kelp_res_fric <- simulateResiduals(kelp_fric)
plot(kelp_res_fric) # Good
spatial_fric <- glmmTMB (fric ~ Habitat + (1|Site) , data=spatial_stats, family = beta_family())
summary(spatial_fric)
Anova(spatial_fric)#Significant
View(spatial_stats)
spatial_res_fric <- simulateResiduals(spatial_fric)
plot(spatial_res_fric) # Good
kelp_fdis <- glmmTMB(fdis ~ Year + (1|Site), data=kelp_stats, family = beta_family())
summary(kelp_fdis)
Anova(kelp_fdis)#Significative
kelp_res_fdis <- simulateResiduals(kelp_fdis)
plot(kelp_res_fdis) # Good
pairs(emmeans(kelp_fdis, spec=~Year, type="response"))
spatial_fdis <- glmmTMB (fdis ~ Habitat, data=spatial_stats, family = beta_family())
summary(spatial_fdis)
Anova(spatial_fdis)# No diferences - p=0.1097
spatial_res_fdis <- simulateResiduals(spatial_fdis)
plot(spatial_res_fdis) # Good
kelp_fide1 <- glmmTMB(fide_PC1 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
summary(kelp_fide1)
Anova(kelp_fide1) #No significant - p=0.2234
kelp_res_fide1 <- simulateResiduals(kelp_fide1)
plot(kelp_res_fide1) # Good
spatial_fide1 <- glmmTMB (fide_PC1 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide1)
Anova(spatial_fide1)# Not significant - p=0.25
spatial_res_fide1 <- simulateResiduals(spatial_fide1)
plot(spatial_res_fide1) # Good
kelp_fide2 <- glmmTMB(fide_PC2 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
summary(kelp_fide2)
Anova(kelp_fide2) #Significant
kelp_res_fide2 <- simulateResiduals(kelp_fide2)
plot(kelp_res_fide2) # Good
spatial_fide2 <- glmmTMB (fide_PC2 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide2)
Anova(spatial_fide2) #Not significant - p=0.831
spatial_res_fide2 <- simulateResiduals(spatial_fide2)
plot(spatial_res_fide2) # Good
kelp_fide3 <- glmmTMB(fide_PC3 ~ Year + (1|Site), data=kelp_stats, family = gaussian())
summary(kelp_fide3)
Anova(kelp_fide3) #Not significant - p=0.1684
kelp_res_fide3 <- simulateResiduals(kelp_fide3)
plot(kelp_res_fide3) # Good
spatial_fide3 <- glmmTMB (fide_PC3 ~ Habitat + (1|Site),data=spatial_stats, family = gaussian())
summary(spatial_fide3)
Anova(spatial_fide3) #Not significant - p=0.25
spatial_res_fide3 <- simulateResiduals(spatial_fide3)
plot(spatial_res_fide3) # Good
shift3D_kelp_stats$Year_cont <- as.numeric(shift3D_kelp_stats$Year)
kelp_shift <- lmer (shift3D ~ Year_cont + (1|Site1), data=shift3D_kelp_stats)
summary(kelp_shift)
Anova(kelp_shift)
space_shift <- glmmTMB (shift3D ~ Habitat , data=shift3D_space_stats)
summary(space_shift)
Anova(space_shift)
