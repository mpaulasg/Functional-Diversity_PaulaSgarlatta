load(here::here("outputs/", "FD_spatial_Hill.RData"))
load(here::here("data", "spatial_metadata.RData"))
TD_spatial <- as.data.frame(TD_spatial)
View(TD_spatial)
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
load(here::here("outputs/", "FD_nokelp_Hill.RData") )
load(here::here("data", "nokelp_metadata.RData"))
load(here::here("outputs/", "FD_kelp_Hill.RData"))
load(here::here("data", "kelp_metadata.RData"))
load(here::here("outputs/", "FD_spatial_Hill.RData"))
load(here::here("data", "spatial_metadata.RData"))
FD_spatial <- as.data.frame(FD_spatial)
View(FD_spatial)
Fx_spatial_Hill <- spatial_metadata %>%
left_join( rownames_to_column(FD_spatial, "Code"), by="Code" ) %>%
select(Code, Habitat, FD_q0, FD_q1, FD_q2)
# mean and sd of diversity among each site for each year in each habitat type
FDspatial_Hill_toplot_c <- Fx_spatial_Hill %>%
group_by(Habitat) %>%
summarise(
n = n(),
q0_mean = mean(FD_q0),
q0_sd = sd(FD_q0),
q1_mean = mean(FD_q1),
q1_sd = sd(FD_q1),
q2_mean = mean(FD_q2),
q2_sd = sd(FD_q2)
) %>%
mutate(q0_se = q0_sd/sqrt(n), q1_se = q1_sd/sqrt(n), q2_se = q2_sd/sqrt(n) )
View(FDspatial_Hill_toplot_c)
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat), color = Habitat, fill = Habitat) +
geom_point( aes(y=q0_mean), stat="identity", size=2, shape=16, color="floralwhite") +
geom_errorbar( aes(x=Habitat, ymin=q0_mean-q0_se, ymax=q0_mean+q0_se), width=0.1, size=0.8, color="floralwhite") +
geom_point( aes(y=q1_mean), stat="identity", size=2, shape=16, color="firebrick1") +
geom_errorbar( aes(x=Habitat, ymin=q1_mean-q1_se, ymax=q1_mean+q1_se), width=0.1, size=0.8, color="firebrick1") +
geom_point( aes(y=q2_mean), stat="identity", size=2, shape=16, color="coral1") +
geom_errorbar( aes(x=Habitat, ymin=q2_mean-q2_se, ymax=q2_mean+q2_se), width=0.1, size=0.8, color="coral1") +
scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat), color = Habitat, fill = Habitat) +
geom_point( aes(y=q0_mean), stat="identity", size=2, shape=16, color="floralwhite") +
geom_errorbar( aes(x=Habitat, ymin=q0_mean-q0_se, ymax=q0_mean+q0_se), width=0.1, size=0.8, color="floralwhite") +
geom_point( aes(y=q1_mean), stat="identity", size=2, shape=16, color="firebrick1") +
geom_errorbar( aes(x=Habitat, ymin=q1_mean-q1_se, ymax=q1_mean+q1_se), width=0.1, size=0.8, color="firebrick1") +
geom_point( aes(y=q2_mean), stat="identity", size=2, shape=16, color="coral1") +
geom_errorbar( aes(x=Habitat, ymin=q2_mean-q2_se, ymax=q2_mean+q2_se), width=0.1, size=0.8, color="coral1") +
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat), color = Habitat, fill = Habitat) +
geom_line( aes(y=q0_mean), stat="identity", size=2, shape=16, color="floralwhite") +
geom_errorbar( aes(x=Habitat, ymin=q0_mean-q0_se, ymax=q0_mean+q0_se), width=0.1, size=0.8, color="floralwhite") +
geom_line( aes(y=q1_mean), stat="identity", size=2, shape=16, color="firebrick1") +
geom_errorbar( aes(x=Habitat, ymin=q1_mean-q1_se, ymax=q1_mean+q1_se), width=0.1, size=0.8, color="firebrick1") +
geom_line( aes(y=q2_mean), stat="identity", size=2, shape=16, color="coral1") +
geom_errorbar( aes(x=Habitat, ymin=q2_mean-q2_se, ymax=q2_mean+q2_se), width=0.1, size=0.8, color="coral1") +
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
Fx_spatial_Hill
View(Fx_spatial_Hill)
Fx_spatial_Hill <- gather(Fx_spatial_Hill, q, qvalue, 3:5)
View(Fx_spatial_Hill)
FDspatial_Hill_toplot_c <- Fx_spatial_Hill %>%
group_by(Habitat, q) %>%
summarise(
mean.value= mean(qvalue),
sd.value=sd(qvalue), count=n(),
se.mean=sd.value/sqrt(count))
View(FDspatial_Hill_toplot_c)
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value), color = Habitat, fill = Habitat) +
geom_bar( aes(y=q0_mean), stat="identity", size=2, position = position_dodge()) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value), color = Habitat, fill = Habitat) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge()) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value), color = Habitat, fill = Habitat) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge()) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value), color = Habitat, fill = Habitat) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge()) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value)) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge(), color = Habitat, fill = Habitat) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
FDspatial_Hill_toplot_c <- Fx_spatial_Hill %>%
group_by(Habitat, q) %>%
summarise(
mean.value= mean(qvalue),
sd.value=sd(qvalue), count=n(),
se.mean=sd.value/sqrt(count))
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
mapping=aes(x= Habitat, y=mean.value)) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge(), color = Habitat, fill = Habitat) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c,
aes(x= Habitat, y=mean.value)) +
geom_bar( aes(y=mean.value), stat="identity", size=2, position = position_dodge(), color = Habitat, fill = Habitat) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
q_labs <- c(FD_q0="q=0", FD_q1="q=1", FD_q2="q=2")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free", labeller = labeller(q_labs))+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
q_labs <- c(FD_q0="q=0", FD_q1="q=1", FD_q2="q=2")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_grid(.~q, scales="free", labeller = q_labs)+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
q_labs <- c(FD_q0="q=0", FD_q1="q=1", FD_q2="q=2")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free", labeller = q_labs)+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free", labeller = label_parsed)+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
Fx_spatial_Hill <- spatial_metadata %>%
left_join( rownames_to_column(FD_spatial, "Code"), by="Code" ) %>%
select(Code, Habitat, "q=0"=FD_q0, "q=1"=FD_q1, "q=2"=FD_q2)
View(Fx_spatial_Hill)
Fx_spatial_Hill <- gather(Fx_spatial_Hill, q, qvalue, 3:5)
FDspatial_Hill_toplot_c <- Fx_spatial_Hill %>%
group_by(Habitat, q) %>%
summarise(
mean.value= mean(qvalue),
sd.value=sd(qvalue), count=n(),
se.mean=sd.value/sqrt(count))
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free", labeller = label_parsed)+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
# color code for the 3 habitats
hab_colors <- c(Inshore= "mediumseagreen", Midshelf= "lightsalmon1", Offshore="firebrick3")
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), color = "black", stat="identity",
size=2, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
plot_spatial_func_Hill <- ggplot(FDspatial_Hill_toplot_c) +
geom_bar( aes(x= Habitat, y=mean.value, color = Habitat, fill = Habitat), color = "black", stat="identity",
size=0.8, position = position_dodge()) +
geom_errorbar( aes( x= Habitat, ymin = mean.value - sd.value, ymax = mean.value + sd.value),
width=0.1, size=0.8) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
facet_wrap(.~q, scales="free")+
#scale_y_continuous( limits = c(3.7,4.5), breaks = seq(from=3.7, to=4.5, by=0.1)  ) +
labs(x="", y="Hill numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none")
plot_spatial_func_Hill
TD_kelp_Hill <- as.data.frame(TD_kelp_Hill)
FD_kelp_Hill <- as.data.frame(FD_kelp_Hill)
Ftemporal_kelp_Hill<- kelp_metadata %>%
mutate(Habitat="kelp") %>%
left_join( rownames_to_column(FD_kelp_Hill, "Code"), by="Code" ) %>%
select(Site, Year, Habitat, "q=0"=FD_q0, "q=1"=FD_q1, "q=2"=FD_q2)
FD_nokelp_Hill <- as.data.frame(FD_nokelp_Hill)
Ftemporal_nokelp_Hill<- nokelp_metadata %>%
mutate(Habitat="no_kelp") %>%
left_join( rownames_to_column(FD_nokelp_Hill, "Code"), by="Code" ) %>%
select(Site, Year, Habitat, "q=0"=FD_q0, "q=1"=FD_q1, "q=2"=FD_q2)
# merging values for the 2 habitat types
Ftemporal_all_Hill <- bind_rows(Ftemporal_kelp_Hill, Ftemporal_nokelp_Hill )
View(Ftemporal_all_Hill)
Ftemporal_all_Hill <- gather(Ftemporal_all_Hill, q, qvalue, 4:6)
# mean and sd of diversity among each site for each year in each habitat type
Ftemporal_toplot_Hill_c <- Ftemporal_all_Hill %>%
group_by(Year, Habitat, q) %>%
summarise(
mean.value= mean(qvalue),
sd.value=sd(qvalue), count=n(),
se.mean=sd.value/sqrt(count))
unique(Ftemporal_toplot_Hill_c$Year)
year_colors <- c(kelp= "mediumseagreen", no_kelp= "lightsalmon1")
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill_c,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill_c,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
facet_wrap(.~q, scales="free")+
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill_c,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
#scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
facet_wrap(.~q, scales="free")+
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill_c,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_line( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
#scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
facet_wrap(.~q, scales="free")+
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c
plot_tempo_func_Hill_c <- ggplot(Ftemporal_toplot_Hill_c,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=mean.value), stat="identity", size=2, shape=16) +
geom_errorbar( aes(x=Year, ymin = mean.value - sd.value, ymax = mean.value + sd.value), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2002, 2018), breaks = seq(from=2002, to=2018, by=4)  ) +
#scale_y_continuous( limits = c(4.5,6.5), breaks = seq(from=4.5, to=6.5, by=0.5)  ) +
scale_color_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
scale_fill_manual(values=year_colors, name="Habitat", breaks = c("kelp", "no_kelp"), labels=c("Kelp", "No kelp")) +
facet_wrap(.~q, scales="free")+
labs(x="", y="Hill Numbers FD") +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.title = element_text(size=14), legend.text = element_text(size=14),
legend.background = element_blank(), legend.key=element_blank())
plot_tempo_func_Hill_c
## merging all plot into a single figure and saving as png ####
figure1c_Hill <- ( plot_spatial_taxo_c + plot_tempo_taxo_c )
## merging all plot into a single figure and saving as png ####
figure1c_Hill <- ( plot_spatial_func_Hill + plot_tempo_func_Hill_c )
figure1c_Hill
ggsave(figure1c_Hill, file=here::here("outputs/", "figure1c_Hill.png"),
height = 22, width = 25, unit = "cm" )
