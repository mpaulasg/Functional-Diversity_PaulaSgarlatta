load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
#Distances for using dbRDA
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
df_shift3D_kelp_2 <- shift3D_kelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_kelp_stats <- df_shift3D_kelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
shift3D_space_stats <- shift3D_space_eucl_1 %>%
select(x1, x2, shift3D) %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
shift3D_nokelp_stats <- as.double(shift3D_nokelp_stats)
shift3D_nokelp_stats <- as.numeric(shift3D_nokelp_stats)
shift3D_nokelp_stats <- as.matrix(shift3D_nokelp_stats)
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
View(nokelp_metadata)
nokelp_metadata <- nokelp_metadata %>%
rownames<- (.$Code)
nokelp_metadata <- nokelp_metadata %>%
`rownames<- `(.$Code)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(DHARMa)
library(emmeans)
library(vegan)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
nokelp_metadata <- nokelp_metadata %>%
`rownames<- `(.$Code)
library(forcats)
nokelp_metadata <- nokelp_metadata %>%
`rownames<- `(.$Code)
library(stringr)
nokelp_metadata <- nokelp_metadata %>%
`rownames<- `(.$Code)
nokelp_metadata <- nokelp_metadata %>%
`rownames<-`(.$Code)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(DHARMa)
library(emmeans)
library(vegan)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
#Distances for using dbRDA
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
nokelp_metadata <- nokelp_metadata %>%
`rownames<-`(.$Code)
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
View(nokelp_metadata)
shift3D_nokelp_stats <- as.matrix(shift3D_nokelp_stats)
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
shift3D_nokelp_eucl_1
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
View(df_shift3D_nokelp_2)
################################################################################
##
## Script for computing functional identity
## between years for kelp and no kelp sites
##
## Code by Paula Sgarlatta, Camille Magneville and SÃ©bastien VillÃ©ger
##
################################################################################
rm(list=ls()) # cleaning memory
# libraries
library(reshape2)
library(tidyverse)
library(mFD)
# loading data
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
typeof(shift3D_nokelp_eucl)
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(DHARMa)
library(emmeans)
library(vegan)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
dbrda_nokelp  <- capscale(shift3D_nokelp_eucl ~ Year, data = nokelp_metadata)
anova(dbrda_nokelp, by = "terms", permutations = 9999)
dbrda_nokelp
shift3D_nokelp_eucl
shift3D_nokelp_eucl <- shift3D_nokelp_eucl %>%
rownames_to_column(Site)
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
View(df_shift3D_nokelp_2)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1") %>%
as.matrix()
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
##### Distance-based redundancy analysis with jaccard dissimilarity for shift in FIde
typeof(shift3D_nokelp_stats)
View(nokelp_metadata)
nokelp_metadata <- nokelp_metadata %>%
`rownames<-`(.$Code)
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
################################################################################
##
## Script for FD statistical analysis
##
##
## Paula Sgarlatta
##
################################################################################
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(DHARMa)
library(emmeans)
library(vegan)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
#Distances for using dbRDA
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1") %>%
as.matrix()
nokelp_metadata <- nokelp_metadata %>%
`rownames<-`(.$Code)
df_shift3D_kelp_2 <- shift3D_kelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_kelp_stats <- df_shift3D_kelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
shift3D_space_stats <- shift3D_space_eucl_1 %>%
select(x1, x2, shift3D) %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
nokelp_lmm_s <- glmmTMB(sp_richn ~ Year + (1|Site) ,data=nokelp_stats, family = poisson())
nokelp_glmm_s <- glmmTMB(sp_richn ~ Year + (1|Site) ,data=nokelp_stats, family=poisson())
summary(nokelp_glmm_s)
Anova(nokelp_glmm_s)
mod.res <- simulateResiduals(nokelp_glmm_s)
plot(mod.res)
nokelp_glmm_s <- glmmTMB(ln(sp_richn) ~ Year + (1|Site) ,data=nokelp_stats, family=poisson())
nokelp_glmm_s <- glmmTMB(log(sp_richn) ~ Year + (1|Site) ,data=nokelp_stats, family=poisson())
summary(nokelp_glmm_s)
Anova(nokelp_glmm_s)
mod.res <- simulateResiduals(nokelp_glmm_s)
plot(mod.res) #Not good
kelp_glmm_s <- glmmTMB(sp_richn ~ Year + (1|Site) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
Anova(kelp_glmm_s)
kelp_res_s <- simulateResiduals(kelp_glmm_s)
plot(kelp_res_s) #Not good
plot(kelp_res_s) #Good
pairs(emmeans(kelp_res_s, spec=~Year, type="response"))
pairs(emmeans(kelp_glmm_s, spec=~Year, type="response"))
space_glmm_s <- glmmTMB(sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = poisson()) #Error: number of levels of each grouping factor must be < number of observations (problems: Site)
summary(space_glmm_s)
Anova(space_glmm_s)
space_res_s <- simulateResiduals(space_glmm_s)
plot(space_res_s)
pairs(emmeans(space_glmm_s, spec=~Hbaitat, type="response"))
pairs(emmeans(space_glmm_s, spec=~Habitat, type="response"))
nokelp_glmm_fric <- glmmTMB(fric ~ Year + (1|Site), data=nokelp_stats, family = beta_family())
summary(nokelp_glmm_fric)
Anova(nokelp_glmm_fric)
nokelp_res_fric <- simulateResiduals(nokelp_glmm_fric)
plot(nokelp_res_fric) # Good
pairs(emmeans(nokelp_glmm_fric, spec=~Year, type="response"))
kelp_glmm_fric <- glmmTMB(fric ~ Year + (1|Site) ,data=kelp_stats, family = beta_family())
summary(kelp_glmm_fric)
Anova(kelp_glmm_fric)
kelp_res_fric <- simulateResiduals(kelp_glmm_fric)
plot(kelp_res_fric) # Good
pairs(emmeans(kelp_glmm_fric, spec=~Year, type="response"))
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Site) ,data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
pairs(emmeans(spatial_glmm_fric, spec=~Habitat, type="response"))
nokelp_glmm_fdis <- glmmTMB(fdis ~ Year + (1|Site), data=nokelp_stats, family = beta_family())
summary(nokelp_glmm_fdis)
Anova(nokelp_glmm_fdis)
nokelp_res_fdis <- simulateResiduals(nokelp_glmm_fdis)
plot(nokelp_res_fdis) # Good
pairs(emmeans(nokelp_glmm_fdis, spec=~Year, type="response"))
kelp_glmm_fdis <- glmmTMB(fdis ~ Year + (1|Site) ,data=kelp_stats, family = beta_family())
summary(kelp_glmm_fdis)
Anova(kelp_glmm_fdis)
kelp_res_fdis <- simulateResiduals(kelp_glmm_fdis)
plot(kelp_res_fdis) # Good
pairs(emmeans(kelp_glmm_fdis, spec=~Year, type="response"))
spatial_glmm_fdis <- glmmTMB(fdis ~ Habitat + (1|Site) ,data=spatial_stats, family = beta_family())
summary(spatial_glmm_fdis)
Anova(spatial_glmm_fdis)
spatial_res_fdis <- simulateResiduals(spatial_glmm_fdis)
plot(spatial_res_fdis) # Good?
pairs(emmeans(spatial_glmm_fdis, spec=~Habitat, type="response")) # Not significant
nokelp_glmm_fide1 <- glmmTMB(fide_PC1 ~ Year + (1|Site), data=nokelp_stats, family = gaussian()) #Not sure of the family
summary(nokelp_glmm_fide1)
Anova(nokelp_glmm_fide1)
nokelp_res_fide1 <- simulateResiduals(nokelp_glmm_fide1)
plot(nokelp_res_fide1) # Good
pairs(emmeans(nokelp_glmm_fide1, spec=~Year, type="response"))
kelp_glmm_fide1 <- glmmTMB(fide_PC1 ~ Year + (1|Site) ,data=kelp_stats, family = gaussian())
summary(kelp_glmm_fide1)
Anova(kelp_glmm_fide1)
kelp_res_fide1 <- simulateResiduals(kelp_glmm_fide1)
plot(kelp_res_fide1) # Good
pairs(emmeans(kelp_glmm_fide1, spec=~Year, type="response"))
spatial_glmm_fide1 <- glmmTMB(fide_PC1 ~ Habitat + (1|Site) ,data=spatial_stats, family = gaussian())
summary(spatial_glmm_fide1)
Anova(spatial_glmm_fide1)
spatial_res_fide1 <- simulateResiduals(spatial_glmm_fide1)
plot(spatial_res_fide1) # Good?
pairs(emmeans(spatial_glmm_fide1, spec=~Habitat, type="response")) # Not significant
nokelp_glmm_fide2 <- glmmTMB(fide_PC2 ~ Year + (1|Site), data=nokelp_stats, family = gaussian()) #Not sure of the family
summary(nokelp_glmm_fide2)
Anova(nokelp_glmm_fide2)
nokelp_res_fide2 <- simulateResiduals(nokelp_glmm_fide2)
plot(nokelp_res_fide2) # Good
pairs(emmeans(nokelp_glmm_fide2, spec=~Year, type="response"))
kelp_glmm_fide2 <- glmmTMB(fide_PC2 ~ Year + (1|Site) ,data=kelp_stats, family = gaussian())
summary(kelp_glmm_fide2)
Anova(kelp_glmm_fide2)
kelp_res_fide2 <- simulateResiduals(kelp_glmm_fide2)
plot(kelp_res_fide2) # Good
pairs(emmeans(kelp_glmm_fide2, spec=~Year, type="response"))
spatial_glmm_fide2 <- glmmTMB(fide_PC2 ~ Habitat + (1|Site) ,data=spatial_stats, family = gaussian())
summary(spatial_glmm_fide2)
Anova(spatial_glmm_fide2)
spatial_res_fide2 <- simulateResiduals(spatial_glmm_fide2)
plot(spatial_res_fide2) # Good?
nokelp_res_fide3 <- simulateResiduals(nokelp_glmm_fide3)
plot(nokelp_res_fide3) # Good
nokelp_glmm_fide3 <- glmmTMB(fide_PC3 ~ Year + (1|Site), data=nokelp_stats, family = gaussian()) #Not sure of the family
summary(nokelp_glmm_fide3)
Anova(nokelp_glmm_fide3)
nokelp_res_fide3 <- simulateResiduals(nokelp_glmm_fide3)
plot(nokelp_res_fide3) # Good
pairs(emmeans(nokelp_glmm_fide3, spec=~Year, type="response"))
kelp_glmm_fide3 <- glmmTMB(fide_PC3 ~ Year + (1|Site) ,data=kelp_stats, family = gaussian())
summary(kelp_glmm_fide3)
Anova(kelp_glmm_fide3) # Not significant
kelp_res_fide3 <- simulateResiduals(kelp_glmm_fide3)
plot(kelp_res_fide3) # Good
spatial_glmm_fide3 <- glmmTMB(fide_PC3 ~ Habitat + (1|Site) ,data=spatial_stats, family = gaussian())
summary(spatial_glmm_fide3)
Anova(spatial_glmm_fide3)
spatial_res_fide3 <- simulateResiduals(spatial_glmm_fide3)
plot(spatial_res_fide3) # Good?
dbrda_nokelp  <- capscale(shift3D_nokelp_stats ~ Year, data = nokelp_metadata)
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(DHARMa)
library(emmeans)
library(vegan)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata.RData") )
load(here::here("data", "nokelp_metadata.RData") )
load(here::here("data", "spatial_metadata.RData") )
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
#Distances for using dbRDA
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1") %>%
as.matrix()
nokelp_metadata <- nokelp_metadata %>%
`rownames<-`(.$Code)
df_shift3D_kelp_2 <- shift3D_kelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
shift3D_kelp_stats <- df_shift3D_kelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
shift3D_space_stats <- shift3D_space_eucl_1 %>%
select(x1, x2, shift3D) %>%
spread(x2, shift3D) %>%
column_to_rownames("x1")
View(spatial_stats)
library(lme4)
library(glmmTMB)
space_lmm_s <- lmer(sp_richn~ Habitat + (1|Site), data=spatial_stats)
space_lmm_s <- lmer(sp_richn~ (Habitat*Site) + (1|Site), data=spatial_stats)
space_lmm_s <- lmer(sp_richn~ (Habitat|Site) + (1|Site), data=spatial_stats)
space_lmm_s <- lmer(sp_richn~ (Habitat*Site) , data=spatial_stats)
View(kelp_stats)
kelp_glmm_fric <- glmmTMB(fric ~ Year + (1|Site) ,data=kelp_stats, family = beta_family())
summary(kelp_glmm_fric)
Anova(kelp_glmm_fric)
kelp_glmm_s <- glmmTMB(sp_richn ~ Year + (1|Site) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
kelp_res_s <- simulateResiduals(kelp_glmm_s)
plot(kelp_res_s) #Deavition significant
nokelp_glmm_fric <- glmmTMB(fric ~ Year + (1|Site), data=nokelp_stats, family = beta_family())
summary(nokelp_glmm_fric)
Anova(nokelp_glmm_fric)
nokelp_res_fric <- simulateResiduals(nokelp_glmm_fric)
plot(nokelp_res_fric) # Good
install.packages("performance")
library("performance", lib.loc="~/R/win-library/4.1")
check_overdispersion(kelp_glmm_s)
View(df_shift3D_nokelp_2)
View(df_shift3D_kelp_2)
shift3D_nokelp_stats
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
View(fide3_nokelp)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
View(shift3D_nokelp_eucl_1)
shift3D_nokelp_eucl
df_shift3D_nokelp_2 <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(x1, x2, shift3D)
df_shift3D_nokelp_2
shift3D_nokelp_stats <- df_shift3D_nokelp_2 %>%
spread(x2, shift3D) %>%
column_to_rownames("x1") %>%
as.matrix()
shift3D_nokelp_stats
