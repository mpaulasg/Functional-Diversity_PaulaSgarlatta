spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv")) %>%
column_to_rownames("Code") %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 53 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
spatial_biomass <- spatial_summary$asb_tot_w
# species names
spatial_sp <- colnames(spatial_sp_occ)
length(spatial_sp) # 53
spatial_biomass
spatial_biomass <- as.data.frame( spatial_summary$asb_tot_w)
View(spatial_biomass)
spatial_biomass <- as.data.frame(spatial_summary$asb_tot_w) %>%
rename(spatial_summary$asb_tot_w = Biomass)
library(dplyr)
spatial_biomass <- as.data.frame(spatial_summary$asb_tot_w) %>%
dplyr::rename(spatial_summary$asb_tot_w = Biomass)
View(spatial_biomass)
rename(spatial_biomass, spatial_summary$asb_tot_w = Biomass)
rename(spatial_biomass, "spatial_summary$asb_tot_w" = Biomass)
rename(spatial_biomass, "spatial_summary$asb_tot_w" = "Biomass")
spatial_biomass <- as.data.frame(spatial_summary$asb_tot_w) %>%
rename(Biomass = "spatial_summary$asb_tot_w")
write.csv(spatial_biomass, file=here::here("data", "spatial_biomass.csv"),
row.names = FALSE )
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
# loading data
load(here::here("data", "kelp_sp_maxN.RData") )
load(here::here("data", "sp_3D_coord.RData") )
load(here::here("data", "spatial_sp_biom.RData") )
read.csv(here::here("data", "spatial_biomass.csv"))
read.csv(here::here("data", "spatial_biomass.csv"))
biomass <- read.csv(here::here("data", "spatial_biomass.csv"))
View(biomass)
################################################################################
##
## Script for preparing fish occurrence datasets and for computing species positions
## in a multidimensional space according to their trait values
##
## Code by Camille Magneville, Sebastien villeger and Paula Sgarlatta
##
################################################################################
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
library(dplyr)
######### Preparing data #############
## temporal survey data ####
# loading raw data from csv----
# metadata and data from sites that use to have kelp and lost it:
kelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_metadata.csv") )
unique(kelp_metadata$Site) # 5 sites
unique(kelp_metadata$Year) # 14 years
kelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
# summary of surveys and occurrences data ----
kelp_summary <- mFD::asb.sp.summary(asb_sp_w = kelp_sp_maxN)
# retrieve occurrence matrix:
kelp_sp_occ <- kelp_summary$asb_sp_occ
# dimensions
dim(kelp_sp_occ) # 69 assemblages * 101 species
# names of species
kelp_sp <- colnames(kelp_sp_occ)
length(kelp_sp) # 101 sp
## This is to make a graph later
kelp_sp_data <- kelp_sp %>%
as.data.frame() %>%
rename(Species = ".") %>%
mutate(data_1 = "temporal")
#=> temporal data ready ####
## spatial survey data ####
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv")) %>%
column_to_rownames("Code") %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 53 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
# retrieve total biomass per assemblage:
spatial_biomass <- as.data.frame(spatial_summary$asb_tot_w) %>%
rename(Biomass = "spatial_summary$asb_tot_w")
spatial_biomass <- as.data.frame(spatial_summary$asb_tot_w) %>%
rownames_to_column("Site") %>%
rename(Biomass = "spatial_summary$asb_tot_w")
View(spatial_biomass)
write.csv(spatial_biomass, file=here::here("data", "spatial_biomass.csv"),
row.names = FALSE )
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
# loading data
load(here::here("data", "kelp_sp_maxN.RData") )
load(here::here("data", "sp_3D_coord.RData") )
load(here::here("data", "spatial_sp_biom.RData") )
biomass <- read.csv(here::here("data", "spatial_biomass.csv"))
View(biomass)
spatial_fd <- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_3D_coord,
asb_sp_w         = spatial_sp_biom,
ind_vect         = c("fide", "fric", "fdis"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)
spatial_alpha <- spatial_fd$functional_diversity_indices
View(spatial_alpha)
spatial_fd <- spatial_alpha %>%
rownames_to_column("Site") %>%
left_join(biomass, by="Site")
View(spatial_fd)
spatial_fd <- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_3D_coord,
asb_sp_w         = spatial_sp_biom,
ind_vect         = c("fide", "fric", "fdis"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)
spatial_alpha <- spatial_fd$functional_diversity_indices
spatial <- spatial_alpha %>%
rownames_to_column("Site") %>%
left_join(biomass, by="Site")
save(spatial, file=here::here("data", "spatial_alpha_biomass.RData") )
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(mvabund)
library(here)
load(here::here("data", "temporal_alpha_kelp_biomass.RData") )
load(here::here("data", "spatial_alpha_biomass.RData") )
spatial_stats <- spatial_alpha %>%
mutate(Site=sub("_.*", "", Site),Habitat=sub(".*_", "", Site))%>%
dplyr::select(-Site1)
spatial_stats <- spatial %>%
mutate(Site=sub("_.*", "", Site),Habitat=sub(".*_", "", Site))%>%
dplyr::select(-Site1)
spatial_stats <- spatial %>%
mutate(Site=sub("_.*", "", Site),Habitat=sub(".*_", "", Site))%>%
####### GLMM
### TEMPORAL ###
## Species richness
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
spatial_stats <- spatial %>%
mutate(Site=sub("_.*", "", Site),Habitat=sub(".*_", "", Site))
View(spatial_stats)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
dplyr::select(-Site1)
View(kelp_stats)
spatial_stats <- spatial %>%
rename(Site1 = Site) %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1))
View(spatial)
View(spatial)
View(spatial_stats)
spatial_stats <- spatial %>%
rename(Site1 = Site) %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before = Site1)
View(spatial_stats)
spatial_stats <- spatial %>%
rename(Site1 = Site) %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before = Site1) %>%
select(-Site1)
kelp_s <- glmmTMB(sp_richn ~ Year + (1|Site), data=kelp_stats, family = poisson())
summary(kelp_s)
Anova(kelp_s)#Significant - p=0.0002
kelp_res_s <- simulateResiduals(kelp_s)
plot(kelp_res_s) #Good
space_s <- glmmTMB (sp_richn ~ Habitat + (1|Site), data=spatial_stats, family = poisson())
summary(space_s)
Anova(space_s)#Significant - p=0.025
space_res_s <- simulateResiduals(space_s)
plot(space_res_s) #Good
biomass_s <- glmmTMB (Biomass ~ Habitat + (1|Site), data=spatial_stats, family = nbinom2())
summary(biomass_s)
biomass_s <- glmmTMB (Biomass ~ Habitat + (1|Site), data=spatial_stats, family = nbinom1())
summary(biomass_s)
Anova(biomass_s)#Significant - p=0.025
biomass_s <- glmmTMB (Biomass ~ Habitat + (1|Site), data=spatial_stats, family = nbinom2())
summary(biomass_s)
Anova(biomass_s)#Significant - p=0.025
biomass_res_s <- simulateResiduals(biomass_s)
biomass_res_s <- simulateResiduals(biomass_s)
plot(biomass_res_s) #Good
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(dplyr)
library(patchwork)
library(sp)
library(rgdal)
library(raster)
library(rgeos)
library(ggplot2)
library(ozmaps)
library(cowplot)
library(ggspatial)
library(here)
# loading data
load(here::here("data", "spatial_metadata.RData") )
load(here::here("data", "spatial_alpha_biomass.RData") )
load(here::here("data","kelp_metadata.RData") )
load(here::here("data" ,"temporal_alpha_kelp_biomass.RData") )
View(spatial)
spatial_all <- spatial_metadata %>%
left_join( rownames_to_column(spatial_alpha, "Code"), by="Code" ) %>%
dplyr::select(Code, Habitat, TRic=sp_richn, fric, fdis, fide_PC1, fide_PC2, fide_PC3, Biomass)
spatial_all <- spatial_metadata %>%
left_join( rownames_to_column(spatial, "Code"), by="Code" ) %>%
dplyr::select(Code, Habitat, TRic=sp_richn, fric, fdis, fide_PC1, fide_PC2, fide_PC3, Biomass)
# mean and sd of diversity among each site for each year in each habitat type
spatial_toplot <- spatial_all %>%
group_by(Habitat) %>%
summarise(
n = n(),
TRic_mean = mean(TRic),
TRic_sd = sd(TRic),
fric_mean = mean(fric),
fric_sd = sd(fric),
fdis_mean = mean(fdis),
fdis_sd = sd(fdis),
fide_PC1_mean = mean(fide_PC1),
fide_PC1_sd = sd(fide_PC1),
fide_PC2_mean = mean(fide_PC2),
fide_PC2_sd = sd(fide_PC2),
fide_PC3_mean = mean(fide_PC3),
fide_PC3_sd = sd(fide_PC3),
biomass_mean = mean(Biomass),
biomass_sd = sd(Biomass)
) %>%
mutate( TRic_se = TRic_sd/sqrt(n))  %>%
mutate( fric_se = fric_sd/sqrt(n)) %>%
mutate( fdis_se = fdis_sd/sqrt(n)) %>%
mutate( fide_PC1_se = fide_PC1_sd/sqrt(n)) %>%
mutate( fide_PC2_se = fide_PC2_sd/sqrt(n)) %>%
mutate( fide_PC3_se = fide_PC3_sd/sqrt(n)) %>%
mutate( biomass_se = biomass_sd/sqrt(n))
spatial_toplot
View(spatial_all)
View(spatial_metadata)
View(spatial)
spatial_all <- spatial_metadata %>%
left_join( rename (spatial, Code = Site), by="Code" ) %>%
dplyr::select(Code, Habitat, TRic=sp_richn, fric, fdis, fide_PC1, fide_PC2, fide_PC3, Biomass)
View(spatial_all)
# mean and sd of diversity among each site for each year in each habitat type
spatial_toplot <- spatial_all %>%
group_by(Habitat) %>%
summarise(
n = n(),
TRic_mean = mean(TRic),
TRic_sd = sd(TRic),
fric_mean = mean(fric),
fric_sd = sd(fric),
fdis_mean = mean(fdis),
fdis_sd = sd(fdis),
fide_PC1_mean = mean(fide_PC1),
fide_PC1_sd = sd(fide_PC1),
fide_PC2_mean = mean(fide_PC2),
fide_PC2_sd = sd(fide_PC2),
fide_PC3_mean = mean(fide_PC3),
fide_PC3_sd = sd(fide_PC3),
biomass_mean = mean(Biomass),
biomass_sd = sd(Biomass)
) %>%
mutate( TRic_se = TRic_sd/sqrt(n))  %>%
mutate( fric_se = fric_sd/sqrt(n)) %>%
mutate( fdis_se = fdis_sd/sqrt(n)) %>%
mutate( fide_PC1_se = fide_PC1_sd/sqrt(n)) %>%
mutate( fide_PC2_se = fide_PC2_sd/sqrt(n)) %>%
mutate( fide_PC3_se = fide_PC3_sd/sqrt(n)) %>%
mutate( biomass_se = biomass_sd/sqrt(n))
spatial_toplot
View(spatial_toplot)
# color code for the 3 habitats
hab_colors <- c(Inshore= "#482677FF", Midshelf= "#FD6A02", Offshore="#FDE725FF")
plot_spatial_taxo <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=TRic_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=TRic_mean-TRic_se, ymax=TRic_mean+TRic_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
scale_y_continuous( limits = c(0,25), breaks = seq(from=0, to=35, by=5)  ) +
labs(x="", y="Species richness") +
ggtitle(("(b)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", axis.text.x = element_blank(),
plot.title = element_text(size = 16, face = "bold"))
plot_spatial_taxo
plot_spatial_func <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=fric_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=fric_mean-fric_se, ymax=fric_mean+fric_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
scale_y_continuous( limits = c(0,0.5), breaks = seq(from=0, to=0.5, by=0.1)  ) +
labs(x="", y="Functional richness") +
ggtitle(("(d)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_spatial_func
plot_spatial_biomass <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=biomass_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=biomass_mean-biomass_se, ymax=biomass_mean+biomass_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
scale_y_continuous( limits = c(0,0.5), breaks = seq(from=0, to=0.5, by=0.1)  ) +
labs(x="", y="Biomass ") +
ggtitle(("(d)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_spatial_biomass
plot_spatial_biomass <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=biomass_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=biomass_mean-biomass_se, ymax=biomass_mean+biomass_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
# scale_y_continuous( limits = c(0,0.5), breaks = seq(from=0, to=0.5, by=0.1)  ) +
labs(x="", y="Biomass ") +
ggtitle(("(d)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_spatial_biomass
plot_spatial_biomass <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=biomass_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=biomass_mean-biomass_se, ymax=biomass_mean+biomass_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
labs(x="", y="Biomass (g/125m2) ") +
ggtitle(("(d)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_spatial_biomass
plot_spatial_biomass <- ggplot(spatial_toplot) +
geom_bar( aes(x=Habitat, y=biomass_mean, color = Habitat, fill = Habitat), stat="identity", color = "black", size=0.8) +
geom_errorbar( aes(x=Habitat, ymin=biomass_mean-biomass_se, ymax=biomass_mean+biomass_se), width=0.1, size=0.8, colour="black" ) +
scale_color_manual(values=hab_colors) +
scale_fill_manual(values=hab_colors) +
labs(x="", y="Biomass (g/125m2) ") +
ggtitle(("(e)"))+
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_spatial_biomass
temporal_kelp<- kelp_metadata %>%
mutate(Habitat="kelp") %>%
left_join( rownames_to_column(temporal_alpha_kelp, "Code"), by="Code" ) %>%
dplyr::select(Code, Site, Year, Habitat, TRic=sp_richn, fric, fdis, fide_PC1, fide_PC2, fide_PC3 )
# mean and sd of diversity among each site for each year in each habitat type
temporal_toplot <- temporal_kelp %>%
group_by(Year, Habitat) %>%
summarise(
n = n(),
TRic_mean = mean(TRic),
TRic_sd = sd(TRic),
fric_mean = mean(fric),
fric_sd = sd(fric),
fdis_mean = mean(fdis),
fdis_sd = sd(fdis),
fide_PC1_mean = mean(fide_PC1),
fide_PC1_sd = sd(fide_PC1),
fide_PC2_mean = mean(fide_PC2),
fide_PC2_sd = sd(fide_PC2),
fide_PC3_mean = mean(fide_PC3),
fide_PC3_sd = sd(fide_PC3)
) %>%
mutate( TRic_se = TRic_sd/sqrt(n))  %>%
mutate( fric_se = fric_sd/sqrt(n)) %>%
mutate( fdis_se = fdis_sd/sqrt(n)) %>%
mutate( fide_PC1_se = fide_PC1_sd/sqrt(n)) %>%
mutate( fide_PC2_se = fide_PC2_sd/sqrt(n)) %>%
mutate( fide_PC3_se = fide_PC3_sd/sqrt(n))
temporal_toplot
unique(temporal_toplot$Year)
plot_tempo_taxo <- ggplot(temporal_toplot,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=TRic_mean), stat="identity", size=3) +
geom_line(aes(x= Year, y= TRic_mean) , stat="identity", size=1)+
geom_errorbar( aes(x=Year, ymin=TRic_mean-TRic_se, ymax=TRic_mean+TRic_se), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2001, 2019), breaks = seq(from=2002, to=2018, by=4)  ) +
scale_y_continuous( limits = c(15,30), breaks = seq(from=15, to=30, by=5)  ) +
scale_color_manual(values="seagreen4") +
scale_fill_manual(values="seagreen4") +
labs(x="", y="Species richness") +
ggtitle(("(a)")) +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_tempo_taxo
plot_tempo_func <- ggplot(temporal_toplot,
mapping=aes(color = Habitat, fill = Habitat) ) +
geom_point( aes(x=Year, y=fric_mean), stat="identity", size=2, shape=16) +
geom_line(aes(x= Year, y= fric_mean) , stat="identity", size=1)+
geom_errorbar( aes(x=Year, ymin=fric_mean-fric_se, ymax=fric_mean+fric_se), width=0.4, size=0.8) +
scale_x_continuous( limits = c(2001, 2019), breaks = seq(from=2002, to=2018, by=4)  ) +
scale_y_continuous( limits = c(0.4,0.8), breaks = seq(from=0.4, to=0.8, by=0.2)  ) +
scale_color_manual(values="seagreen4") +
scale_fill_manual(values="seagreen4") +
labs(x="", y="Functional richness") +
ggtitle(("(c)")) +
theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (14),colour = "black"), axis.title = element_text(size= (16)),
legend.position = "none", plot.title = element_text(size = 16, face = "bold"))
plot_tempo_func
## merging all plot into a single figure and saving as png ####
figure2 <- ( plot_tempo_taxo + plot_spatial_taxo) / ( plot_tempo_func + plot_spatial_func)
ggsave(figure2, file=here::here("outputs" , "Figure2.jpeg"),
height = 22, width = 25, unit = "cm" )
## merging all plot into a single figure and saving as png ####
figure2 <- ( plot_tempo_taxo + plot_spatial_taxo) / ( plot_tempo_func + plot_spatial_func)/
plot_spatial_biomass
figure2
ggsave(figure2, file=here::here("outputs" , "Figure2.jpeg"),
height = 22, width = 25, unit = "cm" )
library(ggpubr)
## merging all plot into a single figure and saving as png ####
figure2 <- ggarrange ( plot_tempo_taxo, plot_spatial_taxo, plot_tempo_func,  plot_spatial_func,
plot_spatial_biomass, ncol=2, nrow=3)
figure2
## merging all plot into a single figure and saving as png ####
figure2 <- ggarrange ( plot_tempo_taxo, plot_spatial_taxo,
ggarrange(plot_tempo_func,  plot_spatial_func),
plot_spatial_biomass, ncol=2, nrow=3)
figure2
## merging all plot into a single figure and saving as png ####
figure2 <- ggarrange (plot_tempo_taxo, plot_spatial_taxo, ncol=2,
ggarrange(plot_tempo_func,  plot_spatial_func, ncol=2),
plot_spatial_biomass, nrow=3)
figure2
figure2
## merging all plot into a single figure and saving as png ####
figure2 <- ( plot_tempo_taxo + plot_spatial_taxo) / ( plot_tempo_func + plot_spatial_func)/
plot_spatial_biomass
figure2
## merging all plot into a single figure and saving as png ####
figure2a <- ( plot_tempo_taxo + plot_spatial_taxo) / ( plot_tempo_func + plot_spatial_func)
figure2a
figure2 <- figure2a / plot_spatial_biomass
figure2
figure2 <- ggdraw +
drawplot(plot_tempo_taxo, x = 0, y = .33, width = .5, height = .33) +
drawplot(plot_spatial_taxo, x = 0.33, y = .33, width = .5, height = .33) +
drawplot(plot_tempo_func, x = 0, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_func, x = 0.66, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_biomass, x = 1, y = 0, width = .5, height = .66))
figure2 <- ggdraw () +
drawplot(plot_tempo_taxo, x = 0, y = .33, width = .5, height = .33) +
drawplot(plot_spatial_taxo, x = 0.33, y = .33, width = .5, height = .33) +
drawplot(plot_tempo_func, x = 0, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_func, x = 0.66, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_biomass, x = 1, y = 0, width = .5, height = .66)
library(cowplot)
figure2 <- ggdraw () +
drawplot(plot_tempo_taxo, x = 0, y = .33, width = .5, height = .33) +
drawplot(plot_spatial_taxo, x = 0.33, y = .33, width = .5, height = .33) +
drawplot(plot_tempo_func, x = 0, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_func, x = 0.66, y = .66, width = .5, height = .66) +
drawplot(plot_spatial_biomass, x = 1, y = 0, width = .5, height = .66)
figure2 <- ggdraw () +
draw_plot(plot_tempo_taxo, x = 0, y = .33, width = .5, height = .33) +
draw_plot(plot_spatial_taxo, x = 0.33, y = .33, width = .5, height = .33) +
draw_plot(plot_tempo_func, x = 0, y = .66, width = .5, height = .66) +
draw_plot(plot_spatial_func, x = 0.66, y = .66, width = .5, height = .66) +
draw_plot(plot_spatial_biomass, x = 1, y = 0, width = .5, height = .66)
figure2
figure2
figure2 <- (plot_tempo_taxo + plot_tempo_func) / (plot_spatial_taxo + plot_spatial_func)
figure2 <- (plot_tempo_taxo + plot_tempo_func) / (plot_spatial_taxo + plot_spatial_func)/
plot_spatial_biomass
figure2
ggsave(figure2, file=here::here("outputs" , "Figure2.jpeg"),
height = 22, width = 25, unit = "cm" )
figure2 <- ggarrange (plot_tempo_taxo, plot_tempo_func,plot_spatial_taxo, plot_spatial_func,
plot_spatial_biomass, ncol = 2, nrow = 3)
figure2
figure2 <- ggarrange (plot_tempo_taxo, plot_spatial_taxo, plot_tempo_func, plot_spatial_func,
plot_spatial_biomass, ncol = 2, nrow = 3)
figure2
ggsave(figure2, file=here::here("outputs" , "Figure2.jpeg"),
height = 22, width = 25, unit = "cm" )
