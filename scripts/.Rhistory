load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
kelp_perma <- adonis(shift3D ~ Year, data=shift3D_kelp_stats)
print(kelp_perma)
shift3D_kelp_eucl
################################################################################
##
## Script for computing functional identity
## between years for kelp and no kelp sites
##
## Code by Paula Sgarlatta, Camille Magneville and SÃ©bastien VillÃ©ger
##
################################################################################
rm(list=ls()) # cleaning memory
# libraries
library(reshape2)
library(tidyverse)
library(mFD)
# loading data
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
#######No kelp - Fide on the 3 PC axes
fide3_nokelp <- temporal_alpha_nokelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_nokelp_eucl <- dist(fide3_nokelp, method = "euclidean")
shift3D_nokelp_eucl_1 <- dist.to.df( list(shift3D=shift3D_nokelp_eucl) ) %>%
as.data.frame() %>%
mutate(Site1=sub("_.*", "", x1), Site2=sub("_.*", "", x2),
Year1=sub(".*_", "", x1),  Year2=sub(".*_", "", x2))
df_shift3D_nokelp_toplot <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(Year, shift3D)  %>%
group_by(Year) %>%
summarise( n = n(),
shift3D_mean = mean(shift3D),
shift3D_sd = sd(shift3D)
) %>%
mutate(shift3D_se = shift3D_sd/sqrt(n))  %>%
mutate( Habitat = "No_Kelp", .before="Year" )
shift3D_nokelp_stats <- shift3D_nokelp_eucl_1 %>%
filter(Year1==2002 | Year2==2002) %>%
filter(Site1 == Site2) %>%
mutate(Year = pmax ( Year1, Year2 ) ) %>%
select(shift3D, Site1, Site2, Year)
#######kelp - Fide on the 3 PC axes
fide3_kelp <- temporal_alpha_kelp %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_kelp_eucl <- dist(fide3_kelp, method = "euclidean")
shift3D_kelp_eucl
fide3_space <- spatial_alpha %>%
select(fide_PC1,     fide_PC2, fide_PC3)
shift3D_space_eucl <- dist(fide3_space, method = "euclidean")
shift3D_space_eucl
spatial_alpha
Habitat <- spatial_alpha %>%
rownames_to_column("Site")
View(Habitat)
Habitat <- spatial_alpha %>%
rownames_to_column("Site") %>%
mutate(Habitat=sub("_.*", "", Site)) %>%
select(Habitat, Site)
Habitat <- spatial_alpha %>%
rownames_to_column("Site") %>%
mutate(Habitat=sub("*._", "", Site)) %>%
select(Habitat, Site)
Habitat <- spatial_alpha %>%
rownames_to_column("Site") %>%
mutate(Habitat=sub("._*", "", Site)) %>%
select(Habitat, Site)
Habitat <- spatial_alpha %>%
rownames_to_column("Site") %>%
mutate(Habitat=sub(".*_", "", Site)) %>%
select(Habitat, Site)
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_stats.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
space_perma <- adonis(shift3D_space_eucl ~ Habitat, data=Habitat)
Habitat <- spatial_alpha %>%
rownames_to_column("Site") %>%
mutate(Habitat=sub(".*_", "", Site)) %>%
select(Habitat, Site)
space_perma <- adonis(shift3D_space_eucl ~ Habitat, data=Habitat)
print(space_perma)
nokelp_lm <- lm(shift3D ~ Year, data = shift_nokelp)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_stats.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
nokelp_lm <- lm(shift3D ~ Year, data = shift_nokelp)
shift_nokelp <- shift3D_nokelp_stats
kelp_perma <- adonis(shift3D ~ Year, data=shift3D_kelp_stats)
nokelp_lm <- lm(shift3D ~ Year, data = shift_nokelp)
summary(nokelp_lm)
Anova(nokelp_lm)
kelp_lm <- lm(shift3D ~ Year, data=shift3D_kelp_stats)
summary(kelp_lm)
Anova(kelp_lm)
kelp_perma <- adonis(shift3D ~ Year, data=shift3D_kelp_stats)
print(kelp_perma)
View(shift_nokelp)
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
load(here::here("outputs", "temporal_alpha_kelp_all.RData") )
load(here::here("outputs", "spatial_alpha_all.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata_all.RData") )
load(here::here("data", "nokelp_metadata_all.RData") )
load(here::here("data", "spatial_metadata_all.RData") )
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
nokelp_stats <- temporal_alpha_nokelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(nokelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y)
kelp_stats <- temporal_alpha_kelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(kelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -YearID)
spatial_stats <- spatial_alpha_all %>%
rownames_to_column(var = "Site") %>%
left_join(spatial_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -HabitatID)
nokelp_glmm_s <- glmmTMB(sp_richn ~ Year + (1|Sites:Replicate) ,data=nokelp_stats, family=poisson())
summary(nokelp_glmm_s)
Anova(nokelp_glmm_s)
mod.res <- simulateResiduals(nokelp_glmm_s)
plot(mod.res) #Good
pairs(emmeans(nokelp_glmm_s, spec=~Year, type="response"))
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
load(here::here("outputs", "temporal_alpha_kelp_all.RData") )
load(here::here("outputs", "spatial_alpha_all.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata_all.RData") )
load(here::here("data", "nokelp_metadata_all.RData") )
load(here::here("data", "spatial_metadata_all.RData") )
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
nokelp_stats <- temporal_alpha_nokelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(nokelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y)
kelp_stats <- temporal_alpha_kelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(kelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -YearID)
spatial_stats <- spatial_alpha_all %>%
rownames_to_column(var = "Site") %>%
left_join(spatial_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -HabitatID)
nokelp_glmm_s <- glmmTMB(sp_richn ~ Year + (1|Sites:Replicate) ,data=nokelp_stats, family=poisson())
summary(nokelp_glmm_s)
Anova(nokelp_glmm_s)
mod.res <- simulateResiduals(nokelp_glmm_s)
plot(mod.res) #Good
pairs(emmeans(nokelp_glmm_s, spec=~Year, type="response"))
emmeans(nokelp_glmm_s, pairwise~Year, type="response")
emmeans(nokelp_glmm_s, pairwise~Year)
typeof(nokelp_stats$Year)
space_glmm_s <- glmmTMB(sp_richn ~ Habitat + (1|Sites/Replicate), data=spatial_stats, family = poisson())
summary(space_glmm_s)
Anova(space_glmm_s)
space_res_s <- simulateResiduals(space_glmm_s)
plot(space_res_s) #Good?
pairs(emmeans(space_glmm_s, spec=~Habitat, type="response"))
shift_nokelp <- shift3D_nokelp_stats
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_stats.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
shift_nokelp <- shift3D_nokelp_stats
View(shift_nokelp)
nokelp_lm <- lmer(shift3D ~ Year + (1|Site1), data = shift_nokelp)
summary(nokelp_lm)
Anova(nokelp_lm)
shift_nokelp$Year_contin <- as.numeric(shift_nokelp$Year)
nokelp_lm <- lmer(shift3D ~ Year_contin + (1|Site1), data = shift_nokelp)
summary(nokelp_lm)
Anova(nokelp_lm)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
load(here::here("outputs", "temporal_alpha_kelp_all.RData") )
load(here::here("outputs", "spatial_alpha_all.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata_all.RData") )
load(here::here("data", "nokelp_metadata_all.RData") )
load(here::here("data", "spatial_metadata_all.RData") )
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
nokelp_stats <- temporal_alpha_nokelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(nokelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y)
typeof(nokelp_stats$Year)
nokelp_stats$Year_contin <- as.numeric(nokelp_stats$Year)
View(nokelp_stats)
kelp_stats <- temporal_alpha_kelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(kelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -YearID)
kelp_stats$Year_contin <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha_all %>%
rownames_to_column(var = "Site") %>%
left_join(spatial_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -HabitatID)
nokelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites:Replicate) ,data=nokelp_stats, family=poisson())
summary(nokelp_glmm_s)
Anova(nokelp_glmm_s)
mod.res <- simulateResiduals(nokelp_glmm_s)
plot(mod.res) #Good
plot(mod.res) #Good
emmeans(nokelp_glmm_s, pairwise~Year)
check_overdispersion(nokelp_glmm_s) #No overdispersion (dispertion ratio = 0.786)
kelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
kelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites:Replicates) ,data=kelp_stats, family=poisson())
kelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites:Replicate) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
kelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites/Replicate) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
kelp_glmm_s <- glmmTMB(sp_richn ~ Year_contin + (1|Sites) ,data=kelp_stats, family=poisson())
summary(kelp_glmm_s)
Anova(kelp_glmm_s)
kelp_res_s <- simulateResiduals(kelp_glmm_s)
plot(kelp_res_s) #Good
space_glmm_s <- glmmTMB(sp_richn ~ Habitat + (1|Sites/Replicate), data=spatial_stats, family = poisson())
summary(space_glmm_s)
Anova(space_glmm_s)
space_glmm_s <- glmmTMB(sp_richn ~ Habitat + (1|Sites), data=spatial_stats, family = poisson())
summary(space_glmm_s)
Anova(space_glmm_s)
space_res_s <- simulateResiduals(space_glmm_s)
plot(space_res_s) #Good?
plot(space_res_s) #Good?
nokelp_glmm_fric <- glmmTMB(fric ~ Year_contin + (1|Sites:Replicate), data=nokelp_stats, family = beta_family())
summary(nokelp_glmm_fric)
Anova(nokelp_glmm_fric)
nokelp_res_fric <- simulateResiduals(nokelp_glmm_fric)
plot(nokelp_res_fric) # Good
kelp_glmm_fric <- glmmTMB(fric ~ Year_contin + (1|Sites:Replicate) ,data=kelp_stats, family = beta_family())
summary(kelp_glmm_fric)
Anova(kelp_glmm_fric)
kelp_res_fric <- simulateResiduals(kelp_glmm_fric)
plot(kelp_res_fric) # Good
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites:Replicate), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_stats.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
## Preparing data for stats
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
shift_nokelp <- shift3D_nokelp_stats
spatial_lm_fric <- glmmTMB (fric ~ Habitat , data=spatial_stats, family=beta_family())
summary(spatial_lm_fric)
Anova(spatial_lm_fric)
spatial_res_fric <- simulateResiduals(spatial_lm_fric)
plot(spatial_res_fric) # Good
spatial_lm_fric <- lm (fric ~ Habitat , data=spatial_stats)
summary(spatial_lm_fric)
Anova(spatial_lm_fric)
spatial_res_fric <- simulateResiduals(spatial_lm_fric)
plot(spatial_res_fric) # Good
rm(list=ls()) # cleaning memory
##Load packages
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
load(here::here("outputs", "temporal_alpha_kelp_all.RData") )
load(here::here("outputs", "spatial_alpha_all.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata_all.RData") )
load(here::here("data", "nokelp_metadata_all.RData") )
load(here::here("data", "spatial_metadata_all.RData") )
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
spatial_stats <- spatial_alpha_all %>%
rownames_to_column(var = "Site") %>%
left_join(spatial_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -HabitatID)
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites:Replicate), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
pairs(emmeans(spatial_glmm_fric, spec=~Habitat, type="response"))
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp.RData") )
load(here::here("outputs", "temporal_alpha_kelp.RData") )
load(here::here("outputs", "spatial_alpha.RData") )
load(here::here("outputs", "shift3D_nokelp_stats.RData") )
load(here::here("outputs", "shift3D_kelp_stats.RData") )
load(here::here("outputs", "shift3D_space_eucl.RData") )
nokelp_stats <- temporal_alpha_nokelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
kelp_stats <- temporal_alpha_kelp %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Year=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
spatial_stats <- spatial_alpha %>%
rownames_to_column(var = "Site1") %>%
mutate(Site=sub("_.*", "", Site1),Habitat=sub(".*_", "", Site1), .before="Site1")%>%
select(-Site1)
shift_nokelp <- shift3D_nokelp_stats
nokelp_lm_s <- lmer(sp_richn ~ Year + (1|Site) ,data=nokelp_stats)
rm(list=ls()) # cleaning memory
library(tidyverse)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(DHARMa)
library(emmeans)
library(vegan)
library(performance)
library(here)
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
load(here::here("outputs", "temporal_alpha_kelp_all.RData") )
load(here::here("outputs", "spatial_alpha_all.RData") )
load(here::here("outputs", "shift3D_nokelp_eucl_1.RData") )
load(here::here("outputs", "shift3D_kelp_eucl_1 .RData") )
load(here::here("outputs", "shift3D_space_eucl_1 .RData") )
load(here::here("data", "kelp_metadata_all.RData") )
load(here::here("data", "nokelp_metadata_all.RData") )
load(here::here("data", "spatial_metadata_all.RData") )
load(here::here("outputs", "temporal_alpha_nokelp_all.RData") )
nokelp_stats <- temporal_alpha_nokelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(nokelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y)
nokelp_stats$Year_contin <- as.numeric(nokelp_stats$Year)
kelp_stats <- temporal_alpha_kelp_all %>%
rownames_to_column(var = "Site") %>%
left_join(kelp_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -YearID)
kelp_stats$Year_contin <- as.numeric(kelp_stats$Year)
spatial_stats <- spatial_alpha_all %>%
rownames_to_column(var = "Site") %>%
left_join(spatial_metadata_all, by=c("Site"="Code")) %>%
mutate(Sites=Site.y, .before="sp_richn") %>%
select(-Site, -Site.y, -HabitatID)
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites:Replicate), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_glmm_fric <- lmer(fric ~ Habitat + (1|Sites:Replicate), data=spatial_stats)
spatial_glmm_fric <- lmer(fric ~ Habitat + (1|Sites), data=spatial_stats)
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
spatial_glmm_fric <- glmmTMB(fric ~ Habitat + (1|Sites:Replicate), data=spatial_stats, family = beta_family())
summary(spatial_glmm_fric)
Anova(spatial_glmm_fric)
spatial_res_fric <- simulateResiduals(spatial_glmm_fric)
plot(spatial_res_fric) # Good?
