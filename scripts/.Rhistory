View(temporal_sp)
length(temporal_sp) # 124 unique species
temporal_sp_2 <- setdiff(kelp_sp, nokelp_sp)
View(nokelp_sp)
colnames(kelp_sp) <- "Species"
View(kelp_sp)
colnames(nokelp_sp) <- "Species"
sum(kelp_sp %in% nokelp_sp)# 83 species shared
temporal_sp <- unique( c( kelp_sp, nokelp_sp ) )
temporal_sp_2 <- setdiff(kelp_sp, nokelp_sp)
length(tempora_sp_2)
length(temporal_sp) # 124 unique species
View(temporal_sp)
View(temporal_sp_2)
# names of species
kelp_sp <- colnames(kelp_sp_occ) #101 sp
length(kelp_sp) # 101 sp
nokelp_sp <- colnames(nokelp_sp_occ) # 106 sp
length(nokelp_sp) # 106 sp
sum(kelp_sp %in% nokelp_sp)# 83 species shared
intersect(kelp_sp, nokelp_sp)
temporal_sp <- unique( c( kelp_sp, nokelp_sp ) )
length(temporal_sp) # 124 unique species
temporal_sp_2 <- anti_join(kelp_sp, nokelp_sp)
temporal_sp <- unique( kelp_sp, nokelp_sp)
length(temporal_sp) # 124 unique species
temporal_sp
temporal_sp <- unique(c(kelp_sp, nokelp_sp))
length(temporal_sp) # 124 unique species
temporal_sp <- setdiff(kelp_sp, nokelp_sp)
temporal_sp_kelp <- setdiff(kelp_sp, nokelp_sp) #[PS] Sp only in kelp
temporal_sp_nokelp <- setdiff(nokelp_sp, kelp_sp) #[PS] Sp only in no kelp
temporal_sp_nokelp
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
rlang::last_error()
library(dplyr)
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
temporal_sp_kelp <- as.data.frame(setdiff(kelp_sp, nokelp_sp)) #[PS] Sp only in kelp
temporal_sp_nokelp <- as.data.frame((setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
View(temporal_sp_nokelp)
View(temporal_sp_kelp)
colnames(temporal_sp_kelp) <- "Species"
colnames(temporal_sp_nokelp) <- "Species"
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
View(temporal_sp)
temporal_sp <- temporal_sp[order(temporal_sp$Species),]
temporal_sp
length(temporal_sp)
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
# species names
spatial_sp <- colnames(spatial_sp_occ)
length(spatial_sp) # 51
## names of species present in at least one dataset ####
sum(spatial_sp %in% temporal_sp)# 36 species shared
species_allsurveys <- unique( c(temporal_sp ,  spatial_sp) )
length(species_allsurveys) # 139 species
## names of species present in at least one dataset ####
sum(spatial_sp %in% temporal_sp)# 36 species shared
temporal_sp
spatial_sp
# names of species
kelp_sp <- colnames(kelp_sp_occ) #101 sp
length(kelp_sp) # 101 sp
nokelp_sp <- colnames(nokelp_sp_occ) # 106 sp
length(nokelp_sp) # 106 sp
sum(kelp_sp %in% nokelp_sp)# 83 species shared
temporal_sp <- unique(c(kelp_sp, nokelp_sp))
length(temporal_sp) # 124 unique species ##[PS] This is incorrect, so I'll try another thing
temporal_sp_kelp <- setdiff(kelp_sp, nokelp_sp) #[PS] Sp only in kelp
colnames(temporal_sp_kelp) <- "Species"
temporal_sp_kelp <- as.data.frame(setdiff(kelp_sp, nokelp_sp)) #[PS] Sp only in kelp
colnames(temporal_sp_kelp) <- "Species"
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
colnames(temporal_sp_nokelp) <- "Species"
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
temporal_sp <- temporal_sp[order(temporal_sp$Species),]
length(temporal_sp) #41 unique species - THIS IS CORRECT
species_allsurveys <- unique( c(temporal_sp ,  spatial_sp) )
length(species_allsurveys) # 139 species
spatial_sp <- as.data.frame(setdiff(spatial_sp, temporal_sp)) #[PS] Sp only in spatial
colnames(spatial_sp) <- "Species"
temporal_sp_spatial <- as.data.frame(setdiff(temporal_sp, spatial_sp)) #[PS] Sp only in temporal
colnames(temporal_sp_spatial) <- "Species"
species_allsurveys <- bind_rows(spatial_sp, temporal_sp_spatial)
species_allsurveys <- species_allsurveys[order(species_allsurveys$Species),]
length(species_allsurveys) #41 unique species - THIS IS CORRECT
## saving dataframes #####
save(kelp_metadata, file=here::here("data", "kelp_metadata.RData") )
save(kelp_sp_occ, file=here::here("data", "kelp_sp_occ.RData") )
save(kelp_summary, file=here::here("data", "kelp_summary.RData") )
save(nokelp_metadata, file=here::here("data", "nokelp_metadata.RData") )
save(nokelp_sp_occ, file=here::here("data", "nokelp_sp_occ.RData") )
save(nokelp_summary, file=here::here("data", "nokelp_summary.RData") )
save(spatial_metadata, file=here::here("data", "spatial_metadata.RData") )
save(spatial_sp_occ, file=here::here("data", "spatial_sp_occ.RData") )
save(spatial_summary, file=here::here("data", "spatial_summary.RData") )
save(species_allsurveys, file=here::here("data", "species_allsurveys.RData") )
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
# load traits data ----
fish_traits <- read.csv(here::here("data", "raw_data", "fish_traits.csv"), header = T)
# load species names from surveys datasets ----
load(here::here("data", "species_allsurveys.RData") )
length(species_allsurveys) # 139 species
# checking same species in trait and occurrences datasets ----
identical ( sort(species_allsurveys) , sort(fish_traits$Species ) ) # [PS] Can't understand why this is different!
################################################################################
##
## Script for preparing fish occurrence datasets
##
## Code by Camille Magneville, SÃ©bastien villÃ©ger and Paula Sgarlatta
##
################################################################################
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
library(dplyr)
## temporal survey data ####
# loading raw data from csv----
# metadata and data from sites without kelp
nokelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_metadata.csv") )
head(nokelp_metadata)
unique(nokelp_metadata$Site) # 4 sites
unique(nokelp_metadata$Year) # 14 years
nokelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(nokelp_sp_maxN)
# metadata and data from sites that use to have kelp and lost it:
kelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_metadata.csv") )
head(kelp_metadata)
unique(kelp_metadata$Site) # 5 sites
unique(kelp_metadata$Year) # 14 years
kelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(kelp_sp_maxN)
# summary of surveys and occurrences data ----
kelp_summary <- mFD::asb.sp.summary(asb_sp_w = kelp_sp_maxN)
nokelp_summary <- mFD::asb.sp.summary(asb_sp_w = nokelp_sp_maxN)
# retrieve occurrence matrix:
kelp_sp_occ <- kelp_summary$asb_sp_occ
nokelp_sp_occ <- nokelp_summary$asb_sp_occ
# dimensions
dim(kelp_sp_occ) # 69 assemblages * 101 species
dim(nokelp_sp_occ) # 56 assemblages * 106 species
# names of species
kelp_sp <- colnames(kelp_sp_occ) #101 sp
length(kelp_sp) # 101 sp
nokelp_sp <- colnames(nokelp_sp_occ) # 106 sp
length(nokelp_sp) # 106 sp
sum(kelp_sp %in% nokelp_sp)# 83 species shared
temporal_sp <- unique(c(kelp_sp, nokelp_sp))
length(temporal_sp) # 124 unique species ##[PS] This is incorrect, so I'll try another thing
temporal_sp_kelp <- as.data.frame(setdiff(kelp_sp, nokelp_sp)) #[PS] Sp only in kelp
colnames(temporal_sp_kelp) <- "Species"
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
colnames(temporal_sp_nokelp) <- "Species"
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
temporal_sp <- temporal_sp[order(temporal_sp$Species),]
length(temporal_sp) #41 unique species - THIS IS CORRECT
############## => temporal data ready ####
## spatial survey data ####
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
# species names
spatial_sp <- colnames(spatial_sp_occ)
length(spatial_sp) # 51
## names of species present in at least one dataset ####
sum(spatial_sp %in% temporal_sp)# 0 species shared  - ## [PS] Check this
species_allsurveys <- unique( c(temporal_sp ,  spatial_sp) )
length(species_allsurveys) # 92 species
###[PS] Double-check
spatial_sp <- as.data.frame(setdiff(spatial_sp, temporal_sp)) #[PS] Sp only in spatial
colnames(spatial_sp) <- "Species"
temporal_sp_spatial <- as.data.frame(setdiff(temporal_sp, spatial_sp)) #[PS] Sp only in temporal
colnames(temporal_sp_spatial) <- "Species"
species_allsurveys <- bind_rows(spatial_sp, temporal_sp_spatial)
species_allsurveys <- species_allsurveys[order(species_allsurveys$Species),]
length(species_allsurveys) #92 unique species - In this case, the unique function was giving the same result
## saving dataframes #####
save(kelp_metadata, file=here::here("data", "kelp_metadata.RData") )
save(kelp_sp_occ, file=here::here("data", "kelp_sp_occ.RData") )
save(kelp_summary, file=here::here("data", "kelp_summary.RData") )
save(nokelp_metadata, file=here::here("data", "nokelp_metadata.RData") )
save(nokelp_sp_occ, file=here::here("data", "nokelp_sp_occ.RData") )
save(nokelp_summary, file=here::here("data", "nokelp_summary.RData") )
save(spatial_metadata, file=here::here("data", "spatial_metadata.RData") )
save(spatial_sp_occ, file=here::here("data", "spatial_sp_occ.RData") )
save(spatial_summary, file=here::here("data", "spatial_summary.RData") )
save(species_allsurveys, file=here::here("data", "species_allsurveys.RData") )
write.csv(species_allsurveys, file=here::here("data", "raw_data", "species_allsurveys.csv"),
row.names = FALSE )
species_allsurveys <- as.data.frame(species_allsurveys)
View(species_allsurveys)
write.csv(species_allsurveys, file=here::here("data", "raw_data", "species_allsurveys.csv"),
row.names = FALSE )
View(species_allsurveys)
species_allsurveys <- as.data.frame(species_allsurveys)
write.csv(species_allsurveys, file=here::here("data", "raw_data", "species_allsurveys.csv"),
row.names = FALSE )
View(species_allsurveys)
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
library(dplyr)
# metadata and data from sites without kelp
nokelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_metadata.csv") )
head(nokelp_metadata)
unique(nokelp_metadata$Site) # 4 sites
unique(nokelp_metadata$Year) # 14 years
nokelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(nokelp_sp_maxN)
# metadata and data from sites that use to have kelp and lost it:
kelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_metadata.csv") )
head(kelp_metadata)
unique(kelp_metadata$Site) # 5 sites
unique(kelp_metadata$Year) # 14 years
kelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(kelp_sp_maxN)
# summary of surveys and occurrences data ----
kelp_summary <- mFD::asb.sp.summary(asb_sp_w = kelp_sp_maxN)
nokelp_summary <- mFD::asb.sp.summary(asb_sp_w = nokelp_sp_maxN)
# retrieve occurrence matrix:
kelp_sp_occ <- kelp_summary$asb_sp_occ
nokelp_sp_occ <- nokelp_summary$asb_sp_occ
# dimensions
dim(kelp_sp_occ) # 69 assemblages * 101 species
dim(nokelp_sp_occ) # 56 assemblages * 106 species
# names of species
kelp_sp <- colnames(kelp_sp_occ) #101 sp
length(kelp_sp) # 101 sp
nokelp_sp <- colnames(nokelp_sp_occ) # 106 sp
length(nokelp_sp) # 106 sp
sum(kelp_sp %in% nokelp_sp)# 83 species shared
temporal_sp <- unique(c(kelp_sp, nokelp_sp))
length(temporal_sp) # 124 unique species ##[PS] This is incorrect, so I'll try another thing
temporal_sp_kelp <- as.data.frame(setdiff(kelp_sp, nokelp_sp)) #[PS] Sp only in kelp
colnames(temporal_sp_kelp) <- "Species"
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
colnames(temporal_sp_nokelp) <- "Species"
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
temporal_sp <- temporal_sp[order(temporal_sp$Species),]
length(temporal_sp) #41 unique species - THIS IS CORRECT
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
View(spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# species names
spatial_sp <- colnames(spatial_sp_occ)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv")) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
library(tidyverse)
library(here)
library(mFD)
library(dplyr)
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(dplyr)
library(arsenal)
# load traits data ----
# traits of species from sites surveyed through years using BRUVs
# from sites with kelp
kelp_traits <- read.csv(here::here("from_paula", "TemporalBRUV_species_traits_kelp.csv"),
header = T)
head(kelp_traits)
names(kelp_traits) <- c("Species","Size", "Agg", "Position" , "Diet")
nrow(kelp_traits) # 101 sp
# from sites that never had kelp
nokelp_traits <- read.csv(here::here("from_paula", "TemporalBRUV_species_traits_no_kelp.csv"),
header = T)
head(nokelp_traits)
names(nokelp_traits) <- c("Species","Size", "Agg", "Position" , "Diet")
nrow(nokelp_traits) # 106 sp
# traits of species from UVC surveys
spatial_traits <- read.csv(here::here("from_paula", "SpatialUVC_species_traits.csv"),
header = T)
head(spatial_traits)
names(spatial_traits) <- c("Species","Size", "Agg", "Position" , "Diet")
nrow(spatial_traits) # 51 sp
# merging in a single data.frame and keeping only species present in surveys ----
fish_traits <- bind_rows( kelp_traits, nokelp_traits, spatial_traits) %>%
distinct(Species, .keep_all = TRUE ) %>%
as.data.frame()
head(fish_traits)
nrow(fish_traits) # 139 species
fish_traits <- as.data.frame(fish_traits[order(fish_traits$Species),])
# saving as csv file
write.csv(fish_traits, file=here::here("data", "raw_data", "fish_traits.csv"),
row.names = FALSE )
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
## temporal survey data from sites without kelp ####
# loading raw data from csv----
nokelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_no_kelp.csv"))
head(nokelp_metadata)
nokelp_replicates_maxN <- read.csv(here::here("from_paula", "TemporalBRUV_species_maxN_no_kelp.csv"))
head(nokelp_replicates_maxN)
# merging metadata and data
nokelp <- left_join(nokelp_metadata, nokelp_replicates_maxN, by=c("Code"="Site") )
head(nokelp)
# computing total biomass per site for each species ----
nokelp_sites_maxN <- nokelp %>%
pivot_longer(cols= contains("_"), names_to="species") %>%
mutate(value=as.numeric(value)) %>%
group_by(Site, Year, species) %>%
summarize(total=sum(value)) %>%
ungroup() %>%
pivot_wider(names_from = "species", values_from = "total") %>%
mutate(Code=paste(Site, Year,sep="_"), .before="Site")
head(nokelp_sites_maxN)
nokelp_replicates_maxN %>% select( contains("_") ) %>% sum()
nokelp_sites_maxN %>% select( contains("_") ) %>% sum()
# => same total biomass
# splitting into 2 tables ----
TemporalBRUV_nokelp_metadata <- nokelp_sites_maxN %>%
select(Code, Site, Year)
TemporalBRUV_nokelp_species <- nokelp_sites_maxN %>%
select( "Code", contains("_") )
## saving as csv ----
write.csv(TemporalBRUV_nokelp_metadata, file=here::here("data", "raw_data", "TemporalBRUV_nokelp_metadata.csv"), row.names = FALSE )
write.csv(TemporalBRUV_nokelp_species, file=here::here("data", "raw_data", "TemporalBRUV_nokelp_species.csv"), row.names = FALSE)
## end of no kelp ####
################################################################################
## temporal survey data from sites with kelp ####
# loading raw data from csv----
kelp_metadata <- read.csv(here::here("from_paula", "TemporalBRUV_species_metadata_kelp.csv"))
head(kelp_metadata)
kelp_replicates_maxN <- read.csv(here::here("from_paula", "TemporalBRUV_species_maxN_kelp.csv"))
head(kelp_replicates_maxN)
# merging metadata and data
kelp <- left_join(kelp_metadata, kelp_replicates_maxN, by=c("Code"="Site") )
head(kelp)
# computing total biomass per site for each species ----
kelp_sites_maxN <- kelp %>%
pivot_longer(cols= contains("_"), names_to="species") %>%
mutate(value=as.numeric(value)) %>%
group_by(Site, Year, species) %>%
summarize(total=sum(value)) %>%
ungroup() %>%
pivot_wider(names_from = "species", values_from = "total") %>%
mutate(Code=paste(Site, Year,sep="_"), .before="Site")
head(kelp_sites_maxN)
kelp_replicates_maxN %>% select( contains("_") ) %>% sum()
kelp_sites_maxN %>% select( contains("_") ) %>% sum()
# => same total biomass
# splitting into 2 tables ----
TemporalBRUV_kelp_metadata <- kelp_sites_maxN %>%
select(Code, Site, Year)
TemporalBRUV_kelp_species <- kelp_sites_maxN %>%
select( "Code", contains("_") )
## saving as csv ----
write.csv(TemporalBRUV_kelp_metadata, file=here::here("data", "raw_data", "TemporalBRUV_kelp_metadata.csv"), row.names = FALSE )
write.csv(TemporalBRUV_kelp_species, file=here::here("data", "raw_data", "TemporalBRUV_kelp_species.csv"), row.names= FALSE)
## end of script ####
################################################################################
rm(list=ls()) # cleaning memory
# libraries
library(tidyverse)
library(here)
library(mFD)
library(dplyr)
# metadata and data from sites without kelp
nokelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_metadata.csv") )
head(nokelp_metadata)
unique(nokelp_metadata$Site) # 4 sites
unique(nokelp_metadata$Year) # 14 years
nokelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_nokelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(nokelp_sp_maxN)
# metadata and data from sites that use to have kelp and lost it:
kelp_metadata <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_metadata.csv") )
head(kelp_metadata)
unique(kelp_metadata$Site) # 5 sites
unique(kelp_metadata$Year) # 14 years
kelp_sp_maxN <- read.csv(here::here("data", "raw_data", "TemporalBRUV_kelp_species.csv") ) %>%
column_to_rownames("Code") %>%
as.matrix()
head(kelp_sp_maxN)
View(kelp_sp_maxN)
# summary of surveys and occurrences data ----
kelp_summary <- mFD::asb.sp.summary(asb_sp_w = kelp_sp_maxN)
nokelp_summary <- mFD::asb.sp.summary(asb_sp_w = nokelp_sp_maxN)
# retrieve occurrence matrix:
kelp_sp_occ <- kelp_summary$asb_sp_occ
nokelp_sp_occ <- nokelp_summary$asb_sp_occ
# dimensions
dim(kelp_sp_occ) # 69 assemblages * 101 species
dim(nokelp_sp_occ) # 56 assemblages * 106 species
# names of species
kelp_sp <- colnames(kelp_sp_occ) #101 sp
length(kelp_sp) # 101 sp
nokelp_sp <- colnames(nokelp_sp_occ) # 106 sp
length(nokelp_sp) # 106 sp
sum(kelp_sp %in% nokelp_sp)# 83 species shared
temporal_sp <- unique(c(kelp_sp, nokelp_sp))
length(temporal_sp) # 124 unique species ##[PS] This is incorrect, so I'll try another thing
temporal_sp_kelp <- as.data.frame(setdiff(kelp_sp, nokelp_sp)) #[PS] Sp only in kelp
colnames(temporal_sp_kelp) <- "Species"
temporal_sp_nokelp <- as.data.frame(setdiff(nokelp_sp, kelp_sp)) #[PS] Sp only in no kelp
colnames(temporal_sp_nokelp) <- "Species"
temporal_sp <- bind_rows(temporal_sp_kelp, temporal_sp_nokelp)
temporal_sp <- temporal_sp[order(temporal_sp$Species),]
length(temporal_sp) #41 unique species - THIS IS CORRECT
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# retrieve occurrence matrix:
spatial_sp_occ <- spatial_summary$asb_sp_occ
# species names
spatial_sp <- colnames(spatial_sp_occ)
length(spatial_sp) # 51
## names of species present in at least one dataset ####
sum(spatial_sp %in% temporal_sp)# 0 species shared  - ## [PS] Check this
View(kelp_sp_maxN)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
column_to_rownames("Code") %>%
as.matrix()
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
# metadata of surveys and fish biomass (average across UVC transects) ----
spatial_metadata <- read.csv(here::here("data", "raw_data",  "SpatialUVC_metadata_site.csv"))
head(spatial_metadata)
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv"),
header = TRUE, row.names = 1) %>%
column_to_rownames("Code") %>%
as.matrix()
spatial_sp_biom <- read.csv(here::here("data", "raw_data", "SpatialUVC_species_biomass_site_average.csv")) %>%
column_to_rownames("Code") %>%
as.matrix()
dim(spatial_sp_biom) # 9 assemblages * 51 species
# summary of surveys and occurrences data ----
spatial_summary <- mFD::asb.sp.summary(asb_sp_w = spatial_sp_biom)
View(spatial_sp_biom)
